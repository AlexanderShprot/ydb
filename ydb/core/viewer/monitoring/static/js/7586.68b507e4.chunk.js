"use strict";(self.webpackChunkydb_embedded_ui=self.webpackChunkydb_embedded_ui||[]).push([[7586],{50422:(e,r,s)=>{s.d(r,{q:()=>p});var a=s(84317),t=s(17176),o=s(2418),n=s(905),i=s(24362),l=s(17096),d=s(30817);const u=JSON.parse('{"None":"None","15 sec":"15 sec","1 min":"1 min","2 min":"2 min","5 min":"5 min","Refresh":"Refresh"}'),c=(0,d.wZ)("ydb-diagnostics-autorefresh-control",{en:u});var m=s(75859);const v=(0,i.cn)("auto-refresh-control");function p(e){let{className:r}=e;const s=(0,l.zL)(),[i,d]=(0,l.Rj)();return(0,m.jsxs)("div",{className:v(null,r),children:[(0,m.jsx)(t.z,{view:"flat",onClick:()=>{s(n.h.util.invalidateTags(["All"]))},extraProps:{"aria-label":c("Refresh")},children:(0,m.jsx)(t.z.Icon,{children:(0,m.jsx)(a.Z,{})})}),(0,m.jsxs)(o.P,{value:[String(i)],onUpdate:e=>{d(Number(e))},width:85,children:[(0,m.jsx)(o.P.Option,{value:"0",children:c("None")}),(0,m.jsx)(o.P.Option,{value:"15000",children:c("15 sec")}),(0,m.jsx)(o.P.Option,{value:"60000",children:c("1 min")}),(0,m.jsx)(o.P.Option,{value:"120000",children:c("2 min")}),(0,m.jsx)(o.P.Option,{value:"300000",children:c("5 min")})]})]})}},99683:(e,r,s)=>{s.d(r,{l:()=>i});var a=s(68330),t=s(24362),o=s(75859);const n=(0,t.cn)("ydb-cell-with-popover");function i(e){let{children:r,className:s,wrapperClassName:t,...i}=e;return(0,o.jsx)("div",{className:n(null,t),children:(0,o.jsx)(a.J,{className:n("popover",s),...i,children:r})})}},90861:(e,r,s)=>{s.d(r,{m:()=>c});var a=s(27320),t=s(17176),o=s(11050),n=s(81434),i=s(24362),l=s(75859);const d=(0,i.cn)("clipboard-button");function u(e){let{className:r,status:s,title:n,...i}=e;return(0,l.jsx)(a.u,{content:"success"===s?"Copied!":n||"Copy",placement:"bottom-start",children:(0,l.jsx)(t.z,{...i,className:d(null,r),children:(0,l.jsx)(t.z.Icon,{children:(0,l.jsx)(o.K,{status:s,size:16})})})})}function c(e){let{text:r,...s}=e;return(0,l.jsx)(n.h,{text:r,timeout:1e3,children:e=>(0,l.jsx)(u,{...s,status:e})})}},1796:(e,r,s)=>{s.d(r,{p:()=>d});s(68963);var a=s(24362),t=s(52317),o=s(92666),n=s(17096),i=s(75859);const l=(0,a.cn)("storage-disk-progress-bar");function d(e){let{diskAllocatedPercent:r=-1,severity:s,compact:a,faded:d,empty:u,content:c,className:m}=e;const[v]=(0,n.yu)(t.yT),p={inverted:v,compact:a,faded:d,empty:u},h=void 0!==s&&(0,o.b2)(s);h&&(p[h.toLocaleLowerCase()]=!0);return(0,i.jsxs)("div",{className:l(p,m),role:"meter","aria-label":"Disk allocated space","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":r,children:[(()=>{if(a)return(0,i.jsx)("div",{className:l("fill-bar",p),style:{width:"100%"}});const e=v?100-r:r;return r>=0?(0,i.jsx)("div",{className:l("fill-bar",p),style:{width:`${e}%`}}):null})(),c||(!a&&r>=0?(0,i.jsx)("div",{className:l("title"),children:`${Math.round(r)}%`}):null)]})}},69214:(e,r,s)=>{s.d(r,{A:()=>c});var a=s(86017),t=s(75850),o=s(24362),n=s(90861),i=s(68036),l=s(98366),d=s(75859);const u=(0,o.cn)("entity-status");function c(e){let{status:r=t.K.Grey,name:s="",label:o,path:c,iconPath:m,size:v="s",mode:p="color",showStatus:h=!0,externalLink:g=!1,withLeftTrim:N=!1,hasClipboardButton:k,clipboardButtonAlwaysVisible:D=!1,className:b,additionalControls:I}=e;const S=()=>h?(0,d.jsx)(l.J,{className:u("icon"),status:r,size:v,mode:p}):null;return(0,d.jsxs)("div",{className:u(null,b),title:s,children:[m?(w=m,(0,d.jsx)(a.r,{target:"_blank",href:w,children:S()})):S(),o&&(0,d.jsx)("span",{title:o,className:u("label",{size:v,state:r.toLowerCase()}),children:o}),(0,d.jsx)("span",{className:u("link",{"with-left-trim":N}),children:c?g?(0,d.jsx)(a.r,{className:u("name"),href:c,children:s}):(0,d.jsx)(i.h,{className:u("name"),to:c,children:s}):s&&(0,d.jsx)("span",{className:u("name"),children:s})}),k&&(0,d.jsx)(n.m,{text:s,size:"s",className:u("clipboard-button",{visible:D})}),I&&(0,d.jsx)("span",{className:u("additional-controls "),children:I})]});var w}},40073:(e,r,s)=>{s.d(r,{J:()=>h,b:()=>p});var a=s(68963),t=s(44920),o=s(75850),n=s(24362),i=s(52317),l=s(92666),d=s(55850),u=s(62206),c=s(75859);const m=(0,n.cn)("pdisk-storage-popup"),v=[o.K.Orange,o.K.Red,o.K.Yellow],p=(e,r)=>{var s;const{AvailableSize:a,TotalSize:t,State:o,PDiskId:n,NodeId:u,Path:c,Realtime:m,Type:p,Device:h}=e,g=[{label:"PDisk",value:null!==(s=(0,l.CH)(u,n))&&void 0!==s?s:i.jX},{label:"State",value:o||"not available"},{label:"Type",value:p||"unknown"}];return u&&g.push({label:"Node Id",value:u}),r&&u&&r.get(u)&&g.push({label:"Host",value:r.get(u)}),c&&g.push({label:"Path",value:c}),g.push({label:"Available",value:`${(0,d.Uz)(a)} of ${(0,d.Uz)(t)}`}),m&&v.includes(m)&&g.push({label:"Realtime",value:m}),h&&v.includes(h)&&g.push({label:"Device",value:h}),g},h=e=>{let{data:r,nodes:s,...o}=e;const n=a.useMemo((()=>p(r,s)),[r,s]);return(0,c.jsx)(t.G,{contentClassName:m(),placement:["top","bottom"],hasArrow:!0,offset:[0,12],...o,children:(0,c.jsx)(u._P,{title:"PDisk",info:n,size:"s"})})}},67359:(e,r,s)=>{s.d(r,{y:()=>c});var a=s(56829),t=s(24362),o=s(34301),n=s(55850),i=s(75859);const l=(0,t.cn)("progress-viewer"),d=e=>(0,o.uf)((0,o.W0)(Number(e),2)),u=(e,r)=>[d(e),d(r)];function c(e){let{value:r,capacity:s,formatValues:t=u,percents:o,className:d,size:c="xs",colorizeProgress:m,inverseColorize:v,warningThreshold:p=60,dangerThreshold:h=80}=e;const g=(0,a.F)();let N=Math.round(parseFloat(String(r))/parseFloat(String(s))*100)||0;N=N>100?100:N;let k=r,D=s,b="/";o?(k=N+"%",D="",b=""):t&&([k,D]=t(Number(r),Number(s)));let I=v?"danger":"good";m&&(N>p&&N<=h?I="warning":N>h&&(I=v?"good":"danger"),(0,n.kE)(s)||(N=100));const S={width:N+"%"};return(0,n.kE)(r)?(0,i.jsxs)("div",{className:l({size:c,theme:g,status:I},d),children:[(0,i.jsx)("div",{className:l("line"),style:S}),(0,i.jsx)("span",{className:l("text"),children:(0,n.kE)(s)?`${k} ${b} ${D}`:k})]}):(0,i.jsx)("div",{className:`${l({size:c})} ${d} error`,children:"no data"})}},2098:(e,r,s)=>{s.d(r,{G:()=>d});var a=s(2639),t=s(19812),o=s(24362),n=s(89712),i=s(75859);const l=(0,o.cn)("ydb-resizeable-data-table");function d(e){let{columnsWidthLSKey:r,columns:s,settings:o,wrapperClassName:d,...u}=e;const[c,m]=(0,n.M)(r),v=(0,a.B)(s,c),p={...o,defaultResizeable:!0};return(0,i.jsx)("div",{className:l(null,d),children:(0,i.jsx)(t.ZP,{theme:"yandex-cloud",columns:v,onResize:m,settings:p,...u})})}},98366:(e,r,s)=>{s.d(r,{J:()=>m});var a=s(67585),t=s(57225),o=s(71586),n=s(88776),i=s(75850),l=s(24362),d=s(75859);const u=(0,l.cn)("ydb-status-icon"),c={[i.K.Blue]:a.Z,[i.K.Yellow]:t.Z,[i.K.Orange]:o.Z,[i.K.Red]:t.Z};function m(e){let{status:r=i.K.Grey,size:s="s",mode:a="color",className:t}=e;const o={state:r.toLowerCase(),size:s};return"icons"===a&&r in c?(0,d.jsx)(n.J,{className:u("status-icon",o,t),data:c[r]}):(0,d.jsx)("div",{className:u("status-color",o,t)})}},80816:(e,r,s)=>{s.d(r,{a:()=>i});var a=s(14979),t=s(24362),o=s(75859);const n=(0,t.cn)("ydb-usage-label");function i(e){let{value:r,overloadThreshold:s=90,theme:t,...i}=e;return(0,o.jsxs)(a._,{theme:t,className:n({overload:Number(r)>=s}),...i,children:[r||0,"%"]})}},79255:(e,r,s)=>{s.d(r,{c:()=>f});var a=s(34301),t=s(92666),o=s(68963),n=s(24362),i=s(75859);const l=(0,n.cn)("stack"),d=e=>{let{children:r,className:s}=e;return(0,i.jsx)("div",{className:l(null,s),children:o.Children.map(r,((e,r)=>o.isValidElement(e)?(0,i.jsx)("div",{className:l("layer"),style:{"--ydb-stack-level":r},children:e}):null))})};var u=s(92398),c=s(54665),m=s(17880),v=s(5922),p=s(1796),h=s(74170),g=s(44920),N=s(14979),k=s(75850),D=s(52317),b=s(55850),I=s(62206),S=s(40073);const w=(0,n.cn)("vdisk-storage-popup"),y=e=>{let{data:r,nodes:s,...n}=e;const l=(0,t.Iz)(r),d=o.useMemo((()=>l?(e=>{var r,s,t,o;const{VDiskId:n,VDiskState:i,SatisfactionRank:l,DiskSpace:d,FrontQueues:u,Replicated:c,UnsyncedVDisks:m,AllocatedSize:v,ReadThroughput:p,WriteThroughput:h,StoragePoolName:g}=e,N=[{label:"VDisk",value:(0,a.a2)(n)},{label:"State",value:null!==i&&void 0!==i?i:"not available"}];var D,I;return g&&N.push({label:"StoragePool",value:g}),l&&(null===(r=l.FreshRank)||void 0===r?void 0:r.Flag)!==k.K.Green&&N.push({label:"Fresh",value:null===(D=l.FreshRank)||void 0===D?void 0:D.Flag}),l&&(null===(s=l.LevelRank)||void 0===s?void 0:s.Flag)!==k.K.Green&&N.push({label:"Level",value:null===(I=l.LevelRank)||void 0===I?void 0:I.Flag}),l&&null!==(t=l.FreshRank)&&void 0!==t&&t.RankPercent&&N.push({label:"Fresh",value:l.FreshRank.RankPercent}),l&&null!==(o=l.LevelRank)&&void 0!==o&&o.RankPercent&&N.push({label:"Level",value:l.LevelRank.RankPercent}),d&&d!==k.K.Green&&N.push({label:"Space",value:d}),u&&u!==k.K.Green&&N.push({label:"FrontQueues",value:u}),c||N.push({label:"Replicated",value:"NO"}),m&&N.push({label:"UnsyncVDisks",value:m}),Number(v)&&N.push({label:"Allocated",value:(0,b.Uz)(v)}),Number(p)&&N.push({label:"Read",value:(0,b.Qt)(p)}),Number(h)&&N.push({label:"Write",value:(0,b.Qt)(h)}),N})(r):(e=>{const{NodeId:r,PDiskId:s,VSlotId:a,StoragePoolName:t}=e,o=[{label:"State",value:"not available"}];return t&&o.push({label:"StoragePool",value:t}),o.push({label:"NodeId",value:null!==r&&void 0!==r?r:D.jX},{label:"PDiskId",value:null!==s&&void 0!==s?s:D.jX},{label:"VSlotId",value:null!==a&&void 0!==a?a:D.jX}),o})(r)),[r,l]),u=o.useMemo((()=>l&&r.PDisk&&(0,S.b)(r.PDisk,s)),[r,s,l]);return(0,i.jsxs)(g.G,{contentClassName:w(),placement:["top","bottom"],hasArrow:!0,offset:[0,12],...n,children:[r.DonorMode&&(0,i.jsx)(N._,{className:w("donor-label"),children:"Donor"}),(0,i.jsx)(I._P,{title:"VDisk",info:d,size:"s"}),u&&(0,i.jsx)(I._P,{title:"PDisk",info:u,size:"s"})]})},P=(0,n.cn)("ydb-vdisk-component"),x=e=>{let{data:r={},nodes:s,compact:n,showPopup:l,onShowPopup:d,onHidePopup:g,progressBarClassName:N}=e;const k=(0,t.Iz)(r),D=(0,m.X_)(),[b,I]=o.useState(!1),S=o.useRef(null);let w;return D&&(0,v.D)(r.VDiskSlotId)&&(0,v.D)(r.PDiskId)&&(0,v.D)(r.NodeId)?w=(0,c.By)(r.VDiskSlotId,r.PDiskId,r.NodeId):(0,v.D)(r.NodeId)&&k&&(w=(0,c.ax)(c.ZP.node,{id:r.NodeId,activeTab:u.pV},{pdiskId:r.PDiskId,vdiskId:(0,a.a2)(r.VDiskId)})),(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)("div",{className:P(),ref:S,onMouseEnter:()=>{I(!0),null===d||void 0===d||d()},onMouseLeave:()=>{I(!1),null===g||void 0===g||g()},children:(0,i.jsx)(h.h,{to:w,className:P("content"),children:(0,i.jsx)(p.p,{diskAllocatedPercent:r.AllocatedPercent,severity:r.Severity,compact:n,className:N})})}),(0,i.jsx)(y,{data:r,nodes:s,anchorRef:S,open:b||l})]})};function f(e){let{data:r,className:s,stackClassName:o,...n}=e;const l=null===r||void 0===r?void 0:r.Donors,u=l&&l.length>0?(0,i.jsxs)(d,{className:o,children:[(0,i.jsx)(x,{data:r,...n}),l.map((e=>{const r=(0,t.Iz)(e);return(0,i.jsx)(x,{data:e,...n},(0,a.a2)(r?e.VDiskId:e))}))]}):(0,i.jsx)(x,{data:r,...n});return(0,i.jsx)("div",{className:s,children:u})}},17931:(e,r,s)=>{s.d(r,{l:()=>g});var a=s(68963),t=s(1796),o=s(74170),n=s(40073),i=s(79255),l=s(54665),d=s(17880),u=s(5922),c=s(24362),m=s(34301),v=s(92398),p=s(75859);const h=(0,c.cn)("pdisk-storage"),g=e=>{let{data:r={},vDisks:s,showPopup:c,onShowPopup:g,onHidePopup:N,className:k,progressBarClassName:D}=e;const[b,I]=a.useState(!1),S=(0,d.X_)(),w=a.useRef(null),{NodeId:y,PDiskId:P}=r,x=(0,u.D)(y)&&(0,u.D)(P);let f;return x&&(f=(0,l.ax)(l.ZP.node,{id:y,activeTab:v.pV},{pdiskId:P})),x&&S&&(f=(0,l.ds)(P,y)),(0,p.jsxs)(a.Fragment,{children:[(0,p.jsxs)("div",{className:h(null,k),ref:w,children:[null!==s&&void 0!==s&&s.length?(0,p.jsx)("div",{className:h("vdisks"),children:s.map((e=>(0,p.jsx)("div",{className:h("vdisks-item"),style:{flexGrow:Number(e.AllocatedSize)||1},children:(0,p.jsx)(i.c,{data:e,compact:!0,stackClassName:h("donors-stack")})},(0,m.a2)(e.VDiskId))))}):null,(0,p.jsxs)(o.h,{to:f,className:h("content"),onMouseEnter:()=>{I(!0),null===g||void 0===g||g()},onMouseLeave:()=>{I(!1),null===N||void 0===N||N()},children:[(0,p.jsx)(t.p,{diskAllocatedPercent:r.AllocatedPercent,severity:r.Severity,className:D}),(0,p.jsx)("div",{className:h("media-type"),children:r.Type})]})]}),(0,p.jsx)(n.J,{data:r,anchorRef:w,open:b||c})]})}},77382:(e,r,s)=>{s.d(r,{Ty:()=>G,AH:()=>te,k8:()=>oe,mk:()=>ae});var a=s(68963),t=s(71549),o=s(19812),n=s(10502),i=s(14979),l=s(68330),d=s(88776),u=s(99683),c=s(69214),m=s(74170),v=s(80816),p=s(79255),h=s(54665),g=s(95829),N=s(24362),k=s(34301),D=s(15106),b=s(55850),I=s(92666),S=s(17931),w=s(75859);const y=(0,N.cn)("ydb-storage-disks");function P(e){let{vDisks:r=[],nodes:s}=e;const[t,o]=a.useState();return r.length?(0,w.jsxs)("div",{className:y(null),children:[(0,w.jsx)("div",{className:y("vdisks-wrapper"),children:null===r||void 0===r?void 0:r.map((e=>(0,w.jsx)(x,{vDisk:e,nodes:s,highlightedVDisk:t,setHighlightedVDisk:o},(0,k.a2)(e.VDiskId))))}),(0,w.jsx)("div",{className:y("pdisks-wrapper"),children:null===r||void 0===r?void 0:r.map((e=>{var r;return(0,w.jsx)(f,{vDisk:e,nodes:s,highlightedVDisk:t,setHighlightedVDisk:o},(0,I.CH)(e.NodeId,null===e||void 0===e||null===(r=e.PDisk)||void 0===r?void 0:r.PDiskId))}))})]}):null}function x(e){let{nodes:r,vDisk:s,highlightedVDisk:a,setHighlightedVDisk:t}=e;const o={...s,PDisk:void 0},n=(0,k.a2)(s.VDiskId);return(0,w.jsx)("div",{style:{flexGrow:Number(s.AllocatedSize)||1},className:y("vdisk-item"),children:(0,w.jsx)(p.c,{data:o,nodes:r,compact:!0,showPopup:a===n,onShowPopup:()=>t(n),onHidePopup:()=>t(void 0),progressBarClassName:y("vdisk-progress-bar")})})}function f(e){let{vDisk:r,highlightedVDisk:s,setHighlightedVDisk:a}=e;const t=(0,k.a2)(r.VDiskId);return r.PDisk?(0,w.jsx)(S.l,{className:y("pdisk-item"),progressBarClassName:y("pdisk-progress-bar"),data:r.PDisk,showPopup:s===t,onShowPopup:()=>a(t),onHidePopup:()=>a(void 0)}):null}var j=s(10703),R=s(43817);const E=(0,N.cn)("ydb-storage-groups-columns"),G="storageGroupsColumnsWidth",z="MediaType",L="Erasure",V="GroupId",C="Used",T="Limit",M="Usage",O="DiskSpace",F="Read",A="Write",U="VDisks",H="Disks",Z="Degraded",K={name:"PoolName",header:"Pool Name",width:250,render:e=>{var r;let{row:s}=e;const a=null===(r=s.PoolName)||void 0===r?void 0:r.split("/");return a&&(0,w.jsx)(u.l,{wrapperClassName:E("pool-name-wrapper"),content:s.PoolName,placement:["right"],behavior:n.x.Immediate,children:a[a.length-1]})},align:o.ZP.LEFT},_={name:z,header:"Type",width:100,resizeMinWidth:100,align:o.ZP.LEFT,render:e=>{let{row:r}=e;return(0,w.jsxs)(a.Fragment,{children:[(0,w.jsx)(i._,{children:r.MediaType||"\u2014"}),"\xa0",r.Encryption&&(0,w.jsx)(l.J,{content:(0,R.Z)("encrypted"),placement:"right",behavior:n.x.Immediate,children:(0,w.jsx)(i._,{children:(0,w.jsx)(d.J,{data:t.Z,size:18})})})]})},sortable:!1},W={name:L,header:"Erasure",width:100,sortAccessor:e=>e.ErasureSpecies,render:e=>{let{row:r}=e;return r.ErasureSpecies?r.ErasureSpecies:"-"},align:o.ZP.LEFT},$={name:Z,header:"Degraded",width:110,resizeMinWidth:110,render:e=>{let{row:r}=e;return r.Degraded?(0,w.jsxs)(i._,{theme:(0,j._O)(r),children:["Degraded: ",r.Degraded]}):"-"},align:o.ZP.LEFT,defaultOrder:o.ZP.DESCENDING},J={name:M,header:"Usage",width:75,resizeMinWidth:75,render:e=>{let{row:r}=e;return r.Limit?(0,w.jsx)(v.a,{value:r.Usage,theme:(0,j.YC)(r.Usage)}):"-"},sortAccessor:e=>e.Limit?e.Usage:null,align:o.ZP.LEFT},Y={name:V,header:"Group ID",width:130,render:e=>{let{row:r}=e;return r.GroupId?(0,w.jsx)(m.h,{className:E("group-id"),to:(0,h.Uu)(r.GroupId),children:r.GroupId}):"-"},sortAccessor:e=>Number(e.GroupId),align:o.ZP.RIGHT},B={name:C,header:"Used",width:100,render:e=>{let{row:r}=e;return(0,b.Uz)(r.Used,!0)},align:o.ZP.RIGHT},Q={name:T,header:"Limit",width:100,render:e=>{let{row:r}=e;return(0,b.Uz)(r.Limit)},align:o.ZP.RIGHT},q={name:O,header:"Space",width:110,render:e=>{let{row:r}=e;return(0,w.jsx)(c.A,{status:r.DiskSpace})},align:o.ZP.CENTER},X={name:F,header:"Read",width:100,render:e=>{let{row:r}=e;return r.Read?(0,b.Qt)(r.Read):"-"},align:o.ZP.RIGHT},ee={name:A,header:"Write",width:100,render:e=>{let{row:r}=e;return r.Write?(0,b.Qt)(r.Write):"-"},align:o.ZP.RIGHT},re=e=>({name:U,className:E("vdisks-column"),header:"VDisks",render:r=>{var s;let{row:a}=r;return(0,w.jsx)("div",{className:E("vdisks-wrapper"),children:null===(s=a.VDisks)||void 0===s?void 0:s.map((r=>(0,w.jsx)(p.c,{data:r,nodes:e,className:E("vdisks-item")},(0,k.a2)(r.VDiskId))))})},align:o.ZP.CENTER,width:900,resizeable:!1,sortable:!1}),se=e=>({name:H,className:E("disks-column"),header:"Disks",render:r=>{let{row:s}=r;return(0,w.jsx)(P,{vDisks:s.VDisks,nodes:e})},align:o.ZP.CENTER,width:900,resizeable:!1,sortable:!1}),ae=()=>[Y,_,W,J,B,Q].map((e=>({...e,sortable:!1}))),te=(e,r)=>{const s=null!==r&&void 0!==r&&r.useAdvancedStorage?se():re(null===e||void 0===e?void 0:e.nodes);return[K,_,W,$,Y,J,B,s]},oe=(e,r)=>{const s=((e,r)=>{const s=null!==r&&void 0!==r&&r.useAdvancedStorage?se():re(null===e||void 0===e?void 0:e.nodes);return[K,_,W,$,J,Y,B,Q,q,X,ee,s]})(e,r);var a,t;return(a=s,(t=null===r||void 0===r?void 0:r.visibleEntities)===g.G.space?a.filter((e=>e.name!==Z)):t===g.G.missing?a.filter((e=>e.name!==O)):a.filter((e=>e.name!==Z&&e.name!==O))).map((e=>({...e,sortable:(0,D.P)(e.name)})))}},46393:(e,r,s)=>{s.d(r,{M:()=>u,V:()=>d});var a=s(68963),t=s(99337),o=s(52317),n=s(17096),i=s(77382);const l=(e,r)=>{const[s]=(0,n.yu)(o.uJ,!1),i=(0,n.ix)(t.d);return a.useMemo((()=>e({nodes:i},{useAdvancedStorage:s,visibleEntities:r})),[e,i,s,r])},d=e=>l(i.k8,e),u=()=>l(i.AH)},43817:(e,r,s)=>{s.d(r,{Z:()=>n});var a=s(30817);const t=JSON.parse('{"empty.default":"No such groups","empty.out_of_space":"No groups with out of space errors","empty.degraded":"No degraded groups","show_all":"Show all groups","encrypted":"Encrypted group"}'),o=JSON.parse('{"empty.default":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f","empty.out_of_space":"\u041d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043a\u043e\u043d\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u043e","empty.degraded":"\u041d\u0435\u0442 \u0434\u0435\u0433\u0440\u0430\u0434\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u0433\u0440\u0443\u043f\u043f","show_all":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0433\u0440\u0443\u043f\u043f\u044b","encrypted":"\u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430"}'),n=(0,a.wZ)("ydb-storage-groups",{ru:o,en:t})},10703:(e,r,s)=>{s.d(r,{CZ:()=>m,TP:()=>v,YC:()=>c,_O:()=>u,_r:()=>N});var a=s(81413),t=s(95829),o=s(75850),n=s(99106),i=s(51688);const l=(0,n.p)(1,2,["success","warning","danger"]),d={"block-4-2":(0,n.p)(1,2,["success","warning","danger"]),"mirror-3-dc":(0,n.p)(1,3,["success","warning","danger"])},u=e=>{var r;return(void 0!==(r=e.ErasureSpecies)&&r in d?d[e.ErasureSpecies]:l)(e.Degraded)},c=(0,n.p)(80,85,["success","warning","danger"]),m=(0,n.p)(80,85,[o.K.Green,o.K.Yellow,o.K.Red]),v={sortValue:i.Hk.NodeId,sortOrder:a.zE},p={sortValue:"PoolName",sortOrder:a.zE},h={sortValue:"Degraded",sortOrder:a.hr},g={sortValue:"Usage",sortOrder:a.hr};function N(e){return e===t.G.missing?h:e===t.G.space?g:p}},95829:(e,r,s)=>{s.d(r,{G:()=>a,d:()=>t});const a={all:"all",missing:"missing",space:"space"},t={groups:"groups",nodes:"nodes"}},26491:(e,r,s)=>{s.d(r,{R:()=>t});var a=s(92092);async function t(e,r){let{version:s="v2",shouldUseGroupsHandler:t,...o}=e;if(t&&"v1"!==s){const e=await window.api.getStorageGroups({...o},r);return(0,a._u)(e)}{const e=await window.api.getStorageInfo({version:s,...o},r);return(0,a.S9)(e)}}},33058:(e,r,s)=>{s.d(r,{y:()=>n});var a=s(905),t=s(26491),o=s(92092);const n=a.h.injectEndpoints({endpoints:e=>({getStorageNodesInfo:e.query({queryFn:async(e,r)=>{let{signal:s}=r;try{const r=await window.api.getNodes({storage:!0,type:"static",...e},{signal:s});return{data:(0,o.Y2)(r)}}catch(a){return{error:a}}},providesTags:["All","StorageData"]}),getStorageGroupsInfo:e.query({queryFn:async(e,r)=>{let{signal:s}=r;try{return{data:await(0,t.R)(e,{signal:s})}}catch(a){return{error:a}}},providesTags:["All","StorageData"]})}),overrideExisting:"throw"})},92092:(e,r,s)=>{s.d(r,{S9:()=>h,Y2:()=>p,_u:()=>g});var a=s(21897),t=s(17632),o=s(92666),n=s(3764),i=s(51688),l=s(15106);function d(e){const{DiskSpace:r,VDisks:s=[]}=e;return r||(0,o.b2)(Math.max(...s.map((e=>(0,o.Or)(e.DiskSpace)))))}const u=(e,r)=>{var s;const a=(0,n.w)(e);return{...a,StoragePoolName:r,Donors:null===a||void 0===a||null===(s=a.Donors)||void 0===s?void 0:s.map((e=>({...e,StoragePoolName:r})))}},c=e=>{const{VDisks:r=[],PoolName:s,Usage:a=0,Read:t=0,Write:o=0,Used:n=0,Limit:i=0,Degraded:l=0,Kind:c,MediaType:m,GroupID:v,Overall:p,GroupGeneration:h}=e,g=r.map((e=>u(e,s))),N=Math.floor(100*Number(a)),k=d(e);return{...e,PoolName:s,GroupId:v,MediaType:m||c,VDisks:g,Usage:N,Overall:p,GroupGeneration:h?String(h):void 0,Read:Number(t),Write:Number(o),Used:Number(n),Limit:Number(i),Degraded:Number(l),DiskSpace:k}},m=(e,r)=>{let s=[];return e?s=e.map(c):null===r||void 0===r||r.forEach((e=>{var r;null===(r=e.Groups)||void 0===r||r.forEach((r=>{s.push(((e,r)=>{var s;let o,i=0,c=0,m=0,v=0,p=0;const{Name:h,MediaType:g}=r;if(e.VDisks)for(const l of e.VDisks){const{Replicated:e,VDiskState:r,AvailableSize:s,AllocatedSize:d,PDisk:u,ReadThroughput:h,WriteThroughput:g}=l,{Type:N,State:k,AvailableSize:D}=(0,n.b)(u);e&&k===a.w.Normal&&r===t.H.OK||(i+=1);const b=Number(null!==s&&void 0!==s?s:D)||0,I=Number(d)||0;c+=I,m+=b+I,v+=Number(h)||0,p+=Number(g)||0,o=!N||N!==o&&o?"Mixed":N}const N=null===(s=e.VDisks)||void 0===s?void 0:s.map((e=>u(e,h))),k=(0,l.I)({Used:c,Limit:m},5),D=d(e);return{...e,GroupGeneration:e.GroupGeneration?String(e.GroupGeneration):void 0,GroupId:e.GroupID,Overall:e.Overall,VDisks:N,Usage:k,Read:v,Write:p,PoolName:h,Used:c,Limit:m,Degraded:i,MediaType:g||o||void 0,DiskSpace:D}})(r,e))}))})),s},v=e=>{var r,s,t;const o=(null===(r=e.PDisks)||void 0===r?void 0:r.filter((e=>e.State!==a.w.Normal)).length)||0,l=null===(s=e.PDisks)||void 0===s?void 0:s.map((r=>({...(0,n.b)(r),NodeId:e.NodeId}))),d=null===(t=e.VDisks)||void 0===t?void 0:t.map((r=>({...(0,n.w)(r),NodeId:e.NodeId})));return{...(0,i.Ns)(e.SystemState),NodeId:e.NodeId,PDisks:l,VDisks:d,Missing:o}},p=e=>{const{Nodes:r,TotalNodes:s,FoundNodes:a}=e,t=null===r||void 0===r?void 0:r.map(v);return{nodes:t,total:Number(s)||(null===t||void 0===t?void 0:t.length),found:Number(a)}},h=e=>{const{StoragePools:r,StorageGroups:s,TotalGroups:a,FoundGroups:t}=e,o=m(s,r);return{groups:o,total:Number(a)||o.length,found:Number(t)}};function g(e){const{FoundGroups:r,TotalGroups:s,StorageGroups:a=[]}=e,t=a.map((e=>{const{Usage:r,Read:s,Write:a,Used:t,Limit:o,MissingDisks:i,VDisks:l=[],Overall:u}=e,c=l.map((e=>{var r;const s=e.Whiteboard,a=null===(r=e.PDisk)||void 0===r?void 0:r.Whiteboard,t=e.NodeId,o={...s,PDiskId:null===a||void 0===a?void 0:a.PDiskId,NodeId:t,PDisk:{...a,NodeId:t}};return(0,n.w)(o)})),m=d(e);return{...e,Usage:Math.floor(Number(r))||0,Read:Number(s),Write:Number(a),Used:Number(t),Limit:Number(o),Degraded:Number(i),Overall:u,VDisks:c,DiskSpace:m}}));return{groups:t,total:Number(s)||t.length,found:Number(r)}}},21897:(e,r,s)=>{let a;s.d(r,{w:()=>a}),function(e){e.Initial="Initial",e.InitialFormatRead="InitialFormatRead",e.InitialFormatReadError="InitialFormatReadError",e.InitialSysLogRead="InitialSysLogRead",e.InitialSysLogReadError="InitialSysLogReadError",e.InitialSysLogParseError="InitialSysLogParseError",e.InitialCommonLogRead="InitialCommonLogRead",e.InitialCommonLogReadError="InitialCommonLogReadError",e.InitialCommonLogParseError="InitialCommonLogParseError",e.CommonLoggerInitError="CommonLoggerInitError",e.Normal="Normal",e.OpenFileError="OpenFileError",e.ChunkQuotaError="ChunkQuotaError",e.DeviceIoError="DeviceIoError",e.Missing="Missing",e.Timeout="Timeout",e.NodeDisconnected="NodeDisconnected",e.Unknown="Unknown"}(a||(a={}))},17632:(e,r,s)=>{let a;s.d(r,{H:()=>a}),function(e){e.Initial="Initial",e.LocalRecoveryError="LocalRecoveryError",e.SyncGuidRecovery="SyncGuidRecovery",e.SyncGuidRecoveryError="SyncGuidRecoveryError",e.OK="OK",e.PDiskError="PDiskError"}(a||(a={}))},48169:(e,r,s)=>{s.d(r,{ok:()=>n,wq:()=>o,wz:()=>l,yf:()=>i});var a=s(27102),t=s(55850);const o=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.y3;const s=/\/node\/\d+\/?$/g;return s.test(String(r))?String(r).replace(s,`/node/${e}/`):`${null!==r&&void 0!==r?r:""}/node/${e}/`},n=e=>{let{nodeId:r,pDiskId:s,host:a}=e;const n="actors/pdisks/pdisk"+(0,t.bJ)(s);return o(r,a)+n},i=e=>{let{nodeId:r,pDiskId:s,vDiskSlotId:a,host:n}=e;const i="actors/vdisks/vdisk"+(0,t.bJ)(s)+"_"+(0,t.bJ)(a);return o(r,n)+i};function l(e,r){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"TabletID";return`${arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.y3}/tablets${r?`/${r}`:""}?${s}=${e}`}},77072:(e,r,s)=>{s.d(r,{i6:()=>i,mG:()=>n,mr:()=>d,oO:()=>o,s:()=>l,tH:()=>u});var a=s(21897),t=s(17632);const o={Grey:0,Green:1,Blue:2,Yellow:3,Orange:4,Red:5},n=Object.entries(o).reduce(((e,r)=>{let[s,a]=r;return{...e,[a]:s}}),{}),i=o.Grey,l=n[i],d={[t.H.OK]:o.Green,[t.H.Initial]:o.Yellow,[t.H.SyncGuidRecovery]:o.Yellow,[t.H.LocalRecoveryError]:o.Red,[t.H.SyncGuidRecoveryError]:o.Red,[t.H.PDiskError]:o.Red},u={[a.w.Initial]:o.Grey,[a.w.Normal]:o.Green,[a.w.InitialFormatRead]:o.Yellow,[a.w.InitialSysLogRead]:o.Yellow,[a.w.InitialCommonLogRead]:o.Yellow,[a.w.InitialFormatReadError]:o.Red,[a.w.InitialSysLogReadError]:o.Red,[a.w.InitialSysLogParseError]:o.Red,[a.w.InitialCommonLogReadError]:o.Red,[a.w.InitialCommonLogParseError]:o.Red,[a.w.CommonLoggerInitError]:o.Red,[a.w.OpenFileError]:o.Red,[a.w.ChunkQuotaError]:o.Red,[a.w.DeviceIoError]:o.Red}},92666:(e,r,s)=>{s.d(r,{CH:()=>l,FR:()=>d,Iz:()=>o,Or:()=>i,b2:()=>n});var a=s(5922),t=s(77072);function o(e){return"VDiskId"in e}function n(e){return void 0===e?t.s:t.mG[e]||t.s}function i(e){return e?t.oO[e]:0}function l(e,r){if((0,a.D)(e)&&(0,a.D)(r))return`${e}-${r}`}function d(e,r,s){return[e,r,s].join("-")}},3764:(e,r,s)=>{s.d(r,{b:()=>p,w:()=>v});var a=s(75850),t=s(99106),o=s(77072);const n=(0,t.p)(85,95,[a.K.Green,a.K.Yellow,a.K.Red]);function i(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const s=function(e){return r=e,void 0!==r&&r in o.tH?o.tH[e]:o.i6;var r}(e.State),a=n(r);return s!==o.i6&&a?Math.max(s,o.oO[a]):s}var l=s(92666);function d(e){if(!(0,l.Iz)(e))return o.i6;const{DiskSpace:r,VDiskState:s,FrontQueues:a,Replicated:t,DonorMode:n}=e;if(!s)return o.i6;const i=u(r),d=function(e){var r;if(!e)return o.i6;return null!==(r=o.mr[e])&&void 0!==r?r:o.i6}(s),c=Math.min(o.oO.Orange,u(a));let m=Math.max(i,d,c);return t||n||m!==o.oO.Green||(m=o.oO.Blue),m}function u(e){var r;return e&&null!==(r=o.oO[e])&&void 0!==r?r:o.i6}const c={HDD:"HDD",SSD:"SSD",MVME:"NVME"};function m(e){if(!e)return;const r=function(e,r){const s={};return Object.entries(r).reduce(((r,a)=>{let[t,o]=a;const n=e.length-r,i=n-o;return s[t]=e.substring(i,n)||"0",r+o}),0),s}(BigInt(e).toString(2),{isSolidState:1,kind:55,typeExt:8});if("1"===r.isSolidState)switch(parseInt(r.typeExt,2)){case 0:return c.SSD;case 2:return c.MVME}else if("0"===r.typeExt)return c.HDD}function v(){var e,r,s,a;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=t.PDisk?p({...t.PDisk,NodeId:null!==(e=t.PDisk.NodeId)&&void 0!==e?e:t.NodeId}):void 0,n=null!==(r=t.PDiskId)&&void 0!==r?r:null===o||void 0===o?void 0:o.PDiskId,i=Number(null!==(s=t.AvailableSize)&&void 0!==s?s:null===o||void 0===o?void 0:o.AvailableSize),l=Number(t.AllocatedSize),u=l+i,c=Math.round(100*l/u),m=null===(a=t.Donors)||void 0===a?void 0:a.map((e=>v({...e,DonorMode:!0}))),h=d(t);return{...t,PDisk:o,PDiskId:n,Donors:m,Severity:h,TotalSize:u,AllocatedPercent:c}}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{AvailableSize:s,TotalSize:a,Category:t}=e,o=m(t),n=Number(s),l=Number(a),d=l-n,u=Math.round(100*d/l),c=i(e,u);return{...r,...e,Type:o,Severity:c,AllocatedSize:d,AllocatedPercent:u}}},99106:(e,r,s)=>{s.d(r,{p:()=>a});const a=(e,r,s)=>a=>0<=a&&a<e?s[0]:e<=a&&a<r?s[1]:r<=a?s[2]:void 0},89712:(e,r,s)=>{s.d(r,{M:()=>n});var a=s(68963),t=s(2639),o=s(18193);const n=e=>{const r=a.useCallback((()=>e?o.r.readUserSettingsValue(e,{}):{}),[e]),s=a.useCallback((r=>{e&&o.r.setUserSettingsValue(e,r)}),[e]);return(0,t.M)({saveSizes:s,getSizes:r})}},15106:(e,r,s)=>{s.d(r,{I:()=>a,P:()=>o});const a=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const s=e.Limit?100*e.Used/e.Limit:0;return Math.floor(s/r)*r},t=["PoolName","Kind","MediaType","Erasure","Degraded","Usage","GroupId","Used","Limit","Read","Write"],o=e=>t.includes(e)}}]);